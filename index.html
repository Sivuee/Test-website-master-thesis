<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>The Hollow - Accuracy Test</title>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-slate-100 p-6 min-h-screen">
    
    <div class="max-w-7xl mx-auto mb-6 text-center">
        <h1 class="text-4xl font-serif font-bold text-slate-800">The Hollow Plot Summary</h1>
        <p class="text-slate-500 italic mt-2">Compare the reference on the right and fix the facts in the editor on the left.</p>
    </div>

    <div class="max-w-7xl mx-auto grid grid-cols-1 lg:grid-cols-12 gap-8">
        
        <div class="bg-white p-8 rounded-2xl shadow-lg border border-slate-200 lg:col-span-8">
            <h2 class="text-xl font-bold mb-4 text-indigo-600 flex items-center">Text editor</h2>
            <textarea id="editor" class="w-full h-[600px] p-6 bg-slate-50 border border-slate-200 rounded-xl outline-none focus:ring-2 focus:ring-indigo-500 text-lg leading-relaxed shadow-inner"></textarea>
            
            <div class="mt-8 flex justify-center">
                <button onclick="calculateAndRedirect()" class="bg-indigo-600 hover:bg-indigo-700 text-white px-12 py-4 rounded-full font-bold text-lg transition-all shadow-md transform hover:scale-105">
                    Analyze Results
                </button>
            </div>
        </div>

        <div id="warningBox" class="p-8 rounded-2xl shadow-lg text-slate-300 border lg:col-span-4 h-fit">
            <h2 id="warningTitle" class="text-xl font-bold mb-4 flex items-center">Warning</h2>
            <p id="warningText" class="font-bold text-white mt-2"></p>
        </div>

    </div>

    <script>
        const originalText = `The eccentric Lucy Angkatell has invited the Christows, along with other members of her extended family, to her estate for the weekend. John Christow is carrying on an affair with Henrietta Savernake, a talented sculptor. The beautiful Veronica Cray, an old flame of Christow's, suddenly appears in the house on Saturday night to borrow a box of matches. She lives at a nearby cottage. Another cottage is occupied by Hercule Poirot, who has been invited for Sunday lunch. John walks Veronica back to her cottage, and returns home at 3 am. The next day, Poirot is witness to a scene that seems strangely staged. Gerda Christow stands with a gun in her hand next to John's body, as it bleeds into the swimming pool. Lucy, Henrietta, and Edward (a cousin of Lucy's and a second cousin of Henrietta) are also present at the scene. John utters a final urgent appeal, "Henrietta", and dies.
It seems obvious that Gerda is the murderer. Henrietta steps forward to take the revolver from her hand, but apparently fumbles and drops it into the swimming pool, destroying the evidence. However, the pistol that Gerda was holding was not the gun used to kill John. None of the witnesses has seen Gerda shoot John. It seems difficult to build a case against any of the other potential suspects. Lucy was the next suspect, as she was seen with a gun in her basket of eggs. However, the gun was the wrong calibre. Henrietta is the next suspect, having left an unusual doodle in the pavilion around the time John was killed. When the murder weapon turns up in Poirot's hedge, it has fingerprints that match none of the suspects.
The family had deliberately misdirected Poirot, as they each knew Gerda was the murderer, and were attempting to save her from imprisonment. Gerda had taken two pistols â€“ shooting John with one, and then planning to be discovered with the other pistol in her hand, later proven not to be the murder weapon. Immediately, Henrietta understood that John's final appeal was for her to help Gerda. Instinctively, Henrietta assumed the responsibility by dropping the gun into the pool, and later goes back to retrieve the second weapon. She hides it in a clay sculpture of a horse in her workshop to avoid the police searches. Later, she gets it handled by a blind match-seller and then places it in Poirot's hedge.
Midge Hardcastle, a less affluent relative of the Angkatells, is also staying at the house. She is in love with Edward, but Edward has always been in love with Henrietta, who had refused several of his marriage proposals. Edward comes to the realisation that Henrietta is no longer the Henrietta he once loved. He looks at Midge and realises that she is no longer "little Midge". Edward asks her to marry him. He goes for a walk with Midge, but coming to a spot where Edward has previously walked with Henrietta, Midge believes that he is still too deeply in love with Henrietta. So, she calls off the wedding.
Edward does not understand that Midge loves him too much to hold him back from Henrietta. Misunderstanding her decision, he attempts suicide by putting his head in a gas oven but he is saved by Midge. With this dramatic proof of his despair at losing her, she relents and the wedding is on again.
With the evidence apparently destroyed or suitably confused, the family believe they have saved Gerda. There is a final clue: the holster in which the murder weapon was kept. Gerda had cut this up and placed it in her workbag. Henrietta rushes to Gerda in an attempt to retrieve it and destroy the final proof of Gerda's guilt.
Poirot arrives, and rearranges the tea cups before Gerda returns from the kitchen. He suspects the cornered and suspicious Gerda would murder Henrietta. Gerda returns and drinks from the cup intended for Henrietta, and dies. Henrietta seeks closure and visits one of John's patients. John's death ended the hope of a cure but she is still showing a resilient spirit. Leaving the hospital, she reflects that there is no happy ending for her. She resolves to embark on a sculpture of herself as "Grief".`;

        // 1. READ DATA FROM QUALTRICS URL
        const params = new URLSearchParams(window.location.search);
        const userId = params.get('uid') || 'anonymous_' + Math.floor(Math.random() * 1000);
        const condition = params.get('cond'); // 0 = baseline, 1 = cond1, 2 = cond2

        // Save these so results.html can see them
        localStorage.setItem('qualtricsID', userId);
        localStorage.setItem('experimentalCondition', condition);

        // 2. APPLY WARNING MESSAGES BASED ON CONDITION
        const warningText = document.getElementById('warningText');
        const warningBox = document.getElementById('warningBox');

        if (condition === '0') {
            warningBox.style.display = 'none'; // Baseline: No warning
        } else if (condition === '1') {
            warningBox.className += " bg-slate-800 border-slate-700";
            warningText.innerText = "Gegenereerde AI content kan fouten bevatten. Verifieer altijd!";
        } else if (condition === '2') {
            warningBox.className += " bg-red-900 border-red-700";
            warningText.innerText = "LET OP: Deze tekst bevat kritieke feitelijke onjuistheden!";
        }

        // 3. PREFILL TEXT
        const errorText = originalText
            .replace(/Savernake/g, "Pringle")
            .replace(/Hercule Poirot/g, "Sherlock Holmes")
            .replace(/swimming pool/g, "tennis court")
            .replace(/gas oven/g, "electric toaster")
            .replace(/Grief/g, "Joy");

        document.getElementById('editor').value = errorText;

        function calculateAndRedirect() {
            const current = document.getElementById('editor').value;
            localStorage.setItem('userText', current);
            window.location.href = 'results.html';
        }
    </script>
</body>
</html>